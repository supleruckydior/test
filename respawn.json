local player = game:GetService("Players").LocalPlayer
local playerGui = player.PlayerGui
-- 遊戲內部資料夾名稱更改(優先度最高)
loadstring(game:HttpGet('https://raw.githubusercontent.com/supleruckydior/test/refs/heads/main/RAN'))()

local mainmission = playerGui.GUI:WaitForChild("主界面"):WaitForChild("主城"):WaitForChild("主线任务"):WaitForChild("按钮"):WaitForChild("提示").Visible
local missionnamelist = playerGui.GUI:WaitForChild("二级界面"):WaitForChild("商店"):WaitForChild("通行证任务"):WaitForChild("背景"):WaitForChild("任务列表")
local everydaymissionnamelist = playerGui.GUI:WaitForChild("二级界面"):WaitForChild("每日任务"):WaitForChild("背景"):WaitForChild("任务列表")
local gamepassgiftnnamelist = playerGui.GUI:WaitForChild("二级界面"):WaitForChild("商店"):WaitForChild("背景"):WaitForChild("右侧界面"):WaitForChild("月通行证"):WaitForChild("背景"):WaitForChild("奖励区"):WaitForChild("奖励列表")

-- ================================================================== --
-- 主線任務
function mainmissionchack()
    mainmission = playerGui.GUI:WaitForChild("主界面"):WaitForChild("主城"):WaitForChild("主线任务"):WaitForChild("按钮"):WaitForChild("提示").Visible 
    if mainmission == true then
        print("任務完成，可領取")
        game:GetService("ReplicatedStorage"):FindFirstChild("\228\186\139\228\187\182")
            :FindFirstChild("\229\133\172\231\148\168")
            :FindFirstChild("\228\184\187\231\186\191\228\187\187\229\138\161")
            :FindFirstChild("\233\162\134\229\143\150\229\165\150\229\138\177")
            :FireServer()
    end
end

-- ========================================================================== --
-- 每日任務
function everydaymission()
    if everydaymissionnamelist then
        for _, child in ipairs(everydaymissionnamelist:GetChildren()) do
            if child:IsA("Frame") and child.Visible == true then
                local missionname = tonumber(child.Name)
                local nameLabel = child:FindFirstChild("名称")
                if nameLabel then
                    local taskProgress = nameLabel.Text:match("%((%d+/%d+)%)")
                    if taskProgress then
                        local A_num, B_num = taskProgress:match("(%d+)%/(%d+)")
                        A_num, B_num = tonumber(A_num), tonumber(B_num)
                        if A_num and B_num and A_num / B_num >= 1 then
                            print("每日任務可領取:", missionname)
                            game:GetService("ReplicatedStorage")
                                :FindFirstChild("\228\186\139\228\187\182")
                                :FindFirstChild("\229\133\172\231\148\168")
                                :FindFirstChild("\230\175\143\230\151\165\228\187\187\229\138\161")
                                :FindFirstChild("\233\162\134\229\143\150\229\165\150\229\138\177")
                                :FireServer(missionname)
                        end
                    end
                end
            end
        end
    end
end

-- ========================================================================== --
-- 通行證任務
function gamepassmission()
    local udpdata = false
    if missionnamelist then
        for _, child in ipairs(missionnamelist:GetChildren()) do
            if child:IsA("Frame") and child.Visible == true then
                local missionname = tonumber(child.Name)
                local nameLabel = child:FindFirstChild("名称")
                if nameLabel then
                    local taskProgress = nameLabel.Text:match("%((%d+/%d+)%)")
                    if taskProgress then
                        local A_num, B_num = taskProgress:match("(%d+)%/(%d+)")
                        A_num, B_num = tonumber(A_num), tonumber(B_num)
                        if A_num and B_num and A_num / B_num >= 1 then
                            print("通行證任務可領取:", missionname)
                            game:GetService("ReplicatedStorage")
                                :FindFirstChild("\228\186\139\228\187\182")
                                :FindFirstChild("\229\133\172\231\148\168")
                                :FindFirstChild("\230\156\136\233\128\154\232\161\140\232\175\129")
                                :FindFirstChild("\229\174\140\230\136\144\228\187\187\229\138\161")
                                :FireServer(missionname)

                            if not udpdata then
                                game:GetService("ReplicatedStorage")
                                    :FindFirstChild("\228\186\139\228\187\182")
                                    :FindFirstChild("\229\133\172\231\148\168")
                                    :FindFirstChild("\230\156\136\233\128\154\232\161\140\232\175\129")
                                    :FindFirstChild("\232\142\183\229\143\150\230\149\176\230\141\174")
                                    :FireServer()
                                udpdata = true
                            end
                        end
                    end
                end
            end
        end
    end
end

-- ========================================================================== --
-- 通行證獎勳
local function gamepassgiftdraw(num, havepadgamepass)
    local args = {[1] = 1, [2] = num}
    game:GetService("ReplicatedStorage")
        :FindFirstChild("\228\186\139\228\187\182")
        :FindFirstChild("\229\133\172\231\148\168")
        :FindFirstChild("\230\156\136\233\128\154\232\161\140\232\175\129")
        :FindFirstChild("\233\162\134\229\143\150")
        :FireServer(unpack(args))
    if havepadgamepass then
        local args = {[1] = 2, [2] = num}
        game:GetService("ReplicatedStorage")
            :FindFirstChild("\228\186\139\228\187\182")
            :FindFirstChild("\229\133\172\231\148\168")
            :FindFirstChild("\230\156\136\233\128\154\232\161\140\232\175\129")
            :FindFirstChild("\233\162\134\229\143\150")
            :FireServer(unpack(args))
    end
end

function gamepassgiftget()
    for index = 1, 50 do
        local gift = gamepassgiftnnamelist:FindFirstChild("gamepassgift" .. index)
        if gift then
            local progressVisible = gift:WaitForChild("进度预制体"):WaitForChild("进度").Visible
            local freeClaimed = gift:WaitForChild("免费"):WaitForChild("背景"):WaitForChild("领取图标").Visible
            local goldClaimed = gift:WaitForChild("黄金"):WaitForChild("背景"):WaitForChild("领取图标").Visible
            if progressVisible and not freeClaimed then
                gamepassgiftdraw(index, false)
            elseif progressVisible and not goldClaimed then
                gamepassgiftdraw(index, true)
            end
        end
    end
end

-- ========================================================================== --
-- 每日寶石
function everydaygem()
    local gemBasePath = playerGui.GUI
        :WaitForChild("\228\186\140\231\186\167\231\149\140\233\157\162")
        :WaitForChild("\229\149\134\229\186\151")
        :WaitForChild("\232\131\140\230\153\175")
        :WaitForChild("\229\143\179\228\190\167\231\149\140\233\157\162")
        :WaitForChild("\230\175\143\230\151\165\231\129\181\231\159\179")

    for i = 1, 4 do
        local button = gemBasePath["\233\146\187\231\159\179" .. i]
        if button then
            local tip = button:FindFirstChild("\233\162\134\229\143\150\230\140\137\233\146\174")
            if tip and tip:FindFirstChild("\230\140\137\233\146\174") and tip["\230\140\137\233\146\174"]:FindFirstChild("\230\143\144\231\164\186") then
                local visible = tip["\230\140\137\233\146\174"]["\230\143\144\231\164\186"].Visible
                if visible then
                    game:GetService("ReplicatedStorage")
                        :WaitForChild("\228\186\139\228\187\182")
                        :WaitForChild("\229\133\172\231\148\168")
                        :WaitForChild("\229\149\134\229\186\151")
                        :WaitForChild("\230\175\143\230\151\165\231\129\181\231\159\179")
                        :WaitForChild("\233\162\134\229\143\150\230\175\143\230\151\165\231\129\181\231\159\179")
                        :FireServer(i)
                    print("已領取寶石位置:", i)
                end
            end
        end
    end
end

-- 單次每日轉盤（包含100-to-1的初始化執行）
function dailyspin()
    local spin = game:GetService("ReplicatedStorage")
        :WaitForChild("\228\186\139\228\187\182")
        :WaitForChild("\229\133\172\231\148\168")
        :WaitForChild("\232\189\172\231\155\152")
        :WaitForChild("\230\138\189\229\165\150")

    -- 一次執行6次抽獎
    for i = 1, 6 do
        spin:FireServer()
    end

    -- 單次執行100到1的FireServer循環
    for i = 100, 1, -1 do
        game:GetService("ReplicatedStorage")
            :WaitForChild("\228\186\139\228\187\182")
            :WaitForChild("\229\133\172\231\148\168")
            :WaitForChild("\233\130\174\228\187\182")
            :WaitForChild("\233\162\134\229\143\150\233\130\174\228\187\182")
            :FireServer(i)
    end

    print("每日轉盤 FireServer() 單次執行完成")
end

-- ========================================================================== --
-- 離線獎勵（單次執行）
function offlinereward()
    game:GetService("ReplicatedStorage")
        :WaitForChild("\228\186\139\228\187\182")
        :WaitForChild("\229\133\172\231\148\168")
        :WaitForChild("\231\166\187\231\186\191\229\165\150\229\138\177")
        :WaitForChild("\233\162\134\229\165\150")
        :FireServer()
    print("離線獎勵 FireServer() 已執行一次")
end

function potionfull()
    local player = game:GetService("Players").LocalPlayer
    local guiPath = player.PlayerGui.GUI["\228\186\140\231\186\167\231\149\140\233\157\162"]
        ["\228\184\187\232\167\146"]["\232\131\140\230\153\175"]
        ["\229\143\179\228\190\167\231\149\140\233\157\162"]
        ["\229\176\143\231\187\191\231\147\182"]["\229\189\162\232\177\161"]
        ["\232\180\167\229\184\129"]["\232\180\167\229\184\129\230\149\176"]

    if not guiPath or not guiPath.Text then return end

    local text = guiPath.Text  -- 例："300/300"
    local left, right = text:match("(%d+)%s*/%s*(%d+)")
    if left and right then
        if tonumber(left) == tonumber(right) then
            local args = { 1 }
            game:GetService("ReplicatedStorage")
                :WaitForChild("\228\186\139\228\187\182")
                :WaitForChild("\229\133\172\231\148\168")
                :WaitForChild("\231\165\157\231\166\143")
                :WaitForChild("\231\165\157\231\166\143")
                :FireServer(unpack(args))
        end
    end
end

--[[
-- 控制開關（單次執行）
    mainmissionchack()
    everydaymission()
    gamepassmission()
    gamepassgiftget()
    everydaygem()
    dailyspin()
    offlinereward()
]]
